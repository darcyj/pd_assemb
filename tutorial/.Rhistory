library(ape)
install.packages(ape)
install.packages("ape")
install.packages("ggplot2")
library(ape)
install.packages("ape")
install.packages("ggplot2")
library("ape")
library(ape)
library("ape", INSTALL_opts = c('--no-lock'))
install.packages("ape", INSTALL_opts = c('--no-lock'))
install.packages("ggplot2", INSTALL_opts = c('--no-lock'))
library("ape")
library("ggplot2")
library("parallel")
source("assembly_model_functions.r")
otutable_raw <- read.table("model_inputs/zOTUtable_filt_1000.txt", skip=1, sep='\t',
header=T, row.names=1, comment.char="")
otutable_raw <- read.table("model_inputs/esv_table.txt", skip=1, sep='\t',
header=T, row.names=1, comment.char="")
otutable_raw <- read.table("model_inputs/esv_table.txt", skip=1, sep='\t',
header=T, row.names=1, comment.char="")
tree_raw <- read.tree("model_inputs/esv_seqs_filt_aln_pfiltered.fasta.treefile")
tree_raw <- read.tree("model_inputs/esv_seqs_filt_aln_pfiltered.fasta.treefile")
metadata_raw <- read.table("model_inputs/movingpix_metadata.txt", stringsAsFactors=F, sep='\t',
header=T, row.names=1, comment.char="")
inputs <- prep_check_inputs(
otutable = otutable_raw,
metadata = metadata_raw,
md_order_col = 11,
tree=tree_raw,
rarefy = TRUE, rare_depth = 5000,
merge_tree_0dists = TRUE, drop_unobserved_otus = TRUE,
name = "all_movingpix_inputs"
)
inputs <- prep_check_inputs(
otutable = otutable_raw,
metadata = metadata_raw,
md_order_col = 11,
tree=tree_raw,
#rarefy = TRUE, rare_depth = 5000,
merge_tree_0dists = TRUE, drop_unobserved_otus = TRUE,
name = "all_movingpix_inputs"
)
inputs <- prep_check_inputs(
otutable = otutable_raw,
metadata = metadata_raw,
md_order_col = 11, distmat=NULL,
tree=tree_raw,
#rarefy = TRUE, rare_depth = 5000,
merge_tree_0dists = TRUE, drop_unobserved_otus = TRUE,
name = "all_movingpix_inputs"
)
inputs <- prep_check_inputs(
otutable=read.table("./model_inputs/esv_table.txt", sep='\t', header=T, row.names=1, comment.char=""),
metadata=read.table("./model_inputs/movingpix_metadata.txt", stringsAsFactors=F, sep='\t', header=T, row.names=1, comment.char=""),
md_order_col=11,
tree=read.tree("./model_inputs/esv_seqs_filt_aln_pfiltered.fasta.treefile"),
distmat=NULL, rarefy=TRUE, rare_depth=5000,
merge_tree_0dists=TRUE, drop_unobserved_otus=TRUE,
name="all_movingpix_inputs"
)
inputs <- prep_check_inputs(
otutable=read.table("model_inputs/esv_table.txt", sep='\t', header=T, row.names=1, comment.char=""),
metadata=read.table("model_inputs/movingpix_metadata.txt", stringsAsFactors=F, sep='\t', header=T, row.names=1, comment.char=""),
md_order_col=11,
tree=read.tree("model_inputs/esv_seqs_filt_aln_pfiltered.fasta.treefile"),
distmat=NULL, rarefy=TRUE, rare_depth=5000,
merge_tree_0dists=TRUE, drop_unobserved_otus=TRUE,
name="all_movingpix_inputs"
)
otutable=read.table("model_inputs/esv_table.txt", sep='\t', header=T, row.names=1, comment.char=""),
otutable=read.table("model_inputs/esv_table.txt", sep='\t', header=T, row.names=1, comment.char="")
pwd()
setwd("/home/jack/Documents/first_author/pd_accumulation/tutorial/")
inputs <- prep_check_inputs(
otutable=read.table("model_inputs/esv_table.txt", sep='\t', header=T, row.names=1, comment.char=""),
metadata=read.table("model_inputs/movingpix_metadata.txt", stringsAsFactors=F, sep='\t', header=T, row.names=1, comment.char=""),
md_order_col=11,
tree=read.tree("model_inputs/esv_seqs_filt_aln_pfiltered.fasta.treefile"),
distmat=NULL, rarefy=TRUE, rare_depth=5000,
merge_tree_0dists=TRUE, drop_unobserved_otus=TRUE,
name="all_movingpix_inputs"
)
inputs <- prep_check_inputs(
otutable = otutable_raw,
metadata = metadata_raw,
md_order_col = 11, distmat=NULL,
tree=tree_raw,
#rarefy = TRUE, rare_depth = 5000,
merge_tree_0dists = TRUE, drop_unobserved_otus = TRUE,
name = "all_movingpix_inputs"
)
otutable_raw <- read.table("model_inputs/esv_table.txt", skip=1, sep='\t',
header=T, row.names=1, comment.char="")
otutable_raw <- read.table("model_inputs/esv_table.txt", skip=1, sep='\t',
header=T, row.names=1, comment.char="")
tree_raw <- read.tree("model_inputs/esv_seqs_filt_aln_pfiltered.fasta.treefile")
tree_raw <- read.tree("model_inputs/esv_seqs_filt_aln_pfiltered.fasta.treefile")
metadata_raw <- read.table("model_inputs/movingpix_metadata.txt", stringsAsFactors=F, sep='\t',
header=T, row.names=1, comment.char="")
head(metadata_raw)
head(otutable_raw)
head(otutable_raw)
read.table("model_inputs/movingpix_metadata.txt", stringsAsFactors=F, sep='\t', header=T, row.names=1, comment.char=""),
otutable_raw2 <- read.table("model_inputs/movingpix_metadata.txt", stringsAsFactors=F, sep='\t', header=T, row.names=1, comment.char="")
head(otutable_raw2)
otutable_raw2 <- read.table("model_inputs/esv_table.txt", sep='\t', header=T, row.names=1, comment.char=""),
otutable_raw2 <- read.table("model_inputs/esv_table.txt", sep='\t', header=T, row.names=1, comment.char="")
head(otutable_raw2)
otutable_raw <- read.table("model_inputs/esv_table.txt", sep='\t', header=T, row.names=1, comment.char="")
otutable_raw <- read.table("model_inputs/esv_table.txt", sep='\t', header=T, row.names=1, comment.char="")
tree_raw <- read.tree("model_inputs/esv_seqs_filt_aln_pfiltered.fasta.treefile")
tree_raw <- read.tree("model_inputs/esv_seqs_filt_aln_pfiltered.fasta.treefile")
metadata_raw <- read.table("model_inputs/movingpix_metadata.txt", stringsAsFactors=F, sep='\t', header=T,
row.names=1, comment.char="")
inputs <- prep_check_inputs(
otutable = otutable_raw,
metadata = metadata_raw,
md_order_col=11,
tree = tree_raw,
distmat=NULL, rarefy=TRUE, rare_depth=5000,
merge_tree_0dists=TRUE, drop_unobserved_otus=TRUE,
name="all_movingpix_inputs"
)
names(inputs)
inputs$metadata$body_site
inputs$metadata$sex
inputs$metadata$individual
inputs$metadata$individual
inputs$metadata$individual
inputs$metadata$sex
inputs$metadata$body_site == "feces" & inputs$metadata$individual == "M3"
subset_inputs()
subset_inputs
prep_check_inputs
male_gut_inputs <- subset_inputs(
inputs_list = inputs,
sub_tf = inputs$metadata$body_site == "feces" & inputs$metadata$individual == "M3",
name="male_gut"
)
inputs$metadata$body_site
male_rpalm_inputs <- subset_inputs(
inputs_list = inputs,
sub_tf = inputs$metadata$body_site == "R_palm" & inputs$metadata$individual == "M3",
name="male_rpalm"
)
male_rpalm_inputs
male_gut_results <- pd_assemb_workflow(
inputs_i = male_gut_inputs,
n_dispersions=500,
n_neutral_sim=500,
ncores = 12
)
male_rpalm_results <- pd_assemb_workflow(
inputs_i = male_rpalm_inputs,
n_dispersions=500,
n_neutral_sim=500,
ncores = 12
)
names(male_rpalm_inputs)
names(male_rpalm_results)
male_rpalm_inputs$info
male_rpalm_results$info
male_rpalm_results$model_fitting$estimate
plot_dispersion_ests_violin(
results_list=list(male_gut_results, male_rpalm_results),
fill_var=c("Gut", "Palm")
)
plot_dispersion_ests_violin(
list(male_gut_results, male_rpalm_results),
fill_var=c("Gut", "Palm")
)
plot_dispersion_ests_violin(
list(male_gut_results, male_rpalm_results),
fill_var=c("Gut", "Palm"),
fill_cols=c("red", "blue")
)
plot_dispersion_ests_violin(
list(male_gut_results, male_rpalm_results),
#fill_var=c("Gut", "Palm"),
fill_cols=c("red", "blue")
)
plot_dispersion_ests_violin( list(male_gut_results, male_rpalm_results) )
male_rpalm_results$neutral_testing$prob
